var count=0;function initializeUI(){count=0;$.ajax({url:"server/server.php",type:"POST",data:{mode:"get_stats"},success:function(p){var i,j="",l=0,g=0,a,b,e,k,d,c,o=[];try{i=$.parseJSON(p)}catch(f){document.getElementById("stats-wrapper").innerHTML='<div class="col-md-12" style="padding: .7rem"><div class="jumbotron jumbotron-transparent"><h1>Du hast noch nichts geübt!</h1></div></div>';return}for(var n in i){if(!i.hasOwnProperty(n)){continue}var h=i[n];if(h.hasOwnProperty("filename")&&h.hasOwnProperty("stats")&&h.hasOwnProperty("lang")){a=h.filename.replace(".txt","").replace(".csv","");d=h.lang.lang1;c=h.lang.lang2;h.stats.hasOwnProperty("answered")?b=h.stats.answered:b=0;h.stats.hasOwnProperty("correct")?k=h.stats.correct:k=0;e=b-k;l+=b;g+=k;count++;o[count]=[b,k];j+='<div class="col-xl-4 col-md-6 col-sm-12 small-box-wrapper"><div class="jumbotron jumbotron-transparent"><i id="delete-'+(parseInt(n)+1)+'" class="material-icons float-right unselectable delete-stats"><div content="'+h.filename+'" style="display:none"></div>delete</i><h2>'+a+"</h2>"+d+" - "+c+'<div class="progress progress-custom-small"><div id="correct-'+count+'" class="progress-bar bg-success" style="width:0;height:auto;"></div><div id="wrong-'+count+'" class="progress-bar bg-danger" style="width:0;height:auto;"></div></div>Gesamt: '+b+" | Richtig: "+k+" | Falsch: "+e+" </div></div>"}}if(count===0){document.getElementById("stats-wrapper").innerHTML='<div class="col-md-12" style="padding: .7rem"><div class="jumbotron jumbotron-transparent"><h1>Du hast noch nichts geübt!</h1></div></div>';return}o[0]=[l,g];var m='<div class="col-12 big-box-wrapper"><div class="jumbotron jumbotron-transparent"><i id="delete-0" class="material-icons float-right unselectable delete-stats">delete</i><h1>Alle Lektionen</h1><div class="progress progress-custom-big"><div id="correct-0" class="progress-bar bg-success" style="width:0; height: auto;"></div><div id="wrong-0" class="progress-bar bg-danger" style="width:0; height: auto;"></div></div><p id="p-0">Gesamt: '+l+" | Richtig: "+g+" | Falsch: "+(l-g)+"</p></div></div>";document.getElementById("stats-wrapper").innerHTML=m+j;$(".delete-stats").click(function(){var q=$(this).children().attr("content");q=((typeof q==="undefined")?"all":q);$.ajax({url:"server/server.php",type:"POST",data:{mode:"delete_stat",file:q},success:function(r){var s=$.parseJSON(r);if(s!==null){updateUI(false,s,q)}else{updateUI(true)}}})});animateProgressBars(o)}})}function updateUI(a,h,b){var j=0,n=0;if(a){var k=$("#stats-wrapper");var f='<div class="col-12" style="padding: .7rem"><div class="jumbotron jumbotron-transparent"><h1>Du hast noch nichts geübt!</h1></div></div>';k.html(f).fadeIn()}else{for(var m in h){if(!h.hasOwnProperty(m)){continue}var e=h[m];if(e.hasOwnProperty("answered")){n+=e.answered;if(e.hasOwnProperty("correct")){j+=e.correct}}}$("#p-0").html("Gesamt: "+n+" | Richtig: "+j+" | Falsch: "+(n-j));var g=Math.round(j/n*100);var d=100-g;g+="%";d+="%";var l=$("#wrong-0");var i=$("#correct-0");l.attr("data-original-title",d);i.attr("data-original-title",g);l.animate({width:d},200);i.animate({width:g},200);$('div[content="'+b+'"]').parent().parent().parent().fadeOut()}}$(document).ready(function(){initializeUI()});function animateProgressBars(d){for(var f=0;f<count+1;f++){var e=Math.round(d[f][1]/d[f][0]*100);var a=100-e;e+="%";a+="%";var b=$("#wrong-"+f);var g=$("#correct-"+f);b.attr({dataToggle:"tooltip"}).tooltip({delay:100,title:a,placement:"bottom"});g.attr({dataToggle:"tooltip"}).tooltip({delay:100,title:e,placement:"bottom"});b.css({width:a});g.css({width:e})}};