var list;String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};function uploadFile(c){c.preventDefault();var b=document.getElementById("userfile").files[0];var a=new FileReader();a.readAsText(b,"UTF-8");a.onload=uploadData}function hideAlert(){$("#feedback").fadeOut()}function uploadData(d){var a=d.target.result;var c=document.getElementById("userfile").files[0];var b=$("#feedback");if(!c.name.endsWith(".txt")&&!c.name.endsWith(".csv")){b.addClass("alert-danger");b.html("Dieser Dateityp ist nicht erlaubt!");b.fadeIn();setTimeout(hideAlert,8000);return}if(c.size>100000){b.addClass("alert-danger");b.html("Die Dateigröße darf 100 KB nicht überschreiten!");b.fadeIn();setTimeout(hideAlert,8000);return}$.ajax({url:"server/upload.php",type:"POST",data:{data:a,name:c.name},success:function(e){var f=$.parseJSON(e);b.removeClass("alert-danger","alert-success");if(f.success){b.addClass("alert-success");b.html("<strong>"+c.name+"</strong> erfolgreich hochgeladen!");refreshUI()}else{b.addClass("alert-danger");switch(f.message){case"error_filetype":b.html("Dieser Dateityp ist nicht erlaubt!");break;case"error_html":b.html("Der Dateiname enthält HTML- oder PHP-Tags!");break;case"error_open":b.html("Ups! Auf dem Server ist ein Problem beim Schreiben der Datei aufgetreten! :/");break;case"error_write":b.html("Ups! Auf dem Server ist ein Problem beim Schreiben der Datei aufgetreten! :/");break;case"error_file_exists":b.html("<strong>"+c.name+"</strong> ist bereits vorhanden!");break;case"error_empty_file":b.html("Die ausgewählte Datei ist leer!");break;case"error_line_count":b.html("Die Datei muss mindestens 5 Zeilen haben!");break}}b.fadeIn();setTimeout(hideAlert,8000)}})}function refreshUI(){$.post("server/server.php",{mode:"get_list"},function(d){list=$.parseJSON(d);var e=$("#edit-wrapper");var a=$("#tbody-list");var c="";for(var b=0;b<list.length;b++){c+='<tr><th class="th-icon" scope="row"><span class="badge badge-default unselectable"><div>'+list[b].line_cnt+'</div></span></th><td class="td-content">'+list[b].name+'<span class="badge badge-default unselectable">'+list[b].ext.toUpperCase()+'</span></td><td class="td-icon"><button id="edit-'+b+'" class="material-icons unselectable edit-file">edit_mode</button></td><td class="td-icon"><button id="delete-'+b+'" class="material-icons unselectable delete-file">delete</button></td></tr>'}a.html(c);$(".delete-file").click(function(g){var f=$(this).attr("id");var h=parseInt(f.substr(f.length-1,f.length));deleteFile(h,$(this))})})}$(document).ready(function(){refreshUI()});function editFile(a){}function deleteFile(b,a){$.post("server/server.php",{mode:"delete_file",id:b},function(){a.parents("tr").remove()})};